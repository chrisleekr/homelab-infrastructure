# Trivy configuration
# Reference: https://trivy.dev/docs/latest/references/configuration/config-file/

scan:
  # Enable vulnerability and misconfiguration scanning, disable secret scanning
  # Secret scanning disabled: third-party Ansible collections contain example credentials
  # that trigger false positives (community.aws, google.cloud documentation examples)
  scanners:
    - vuln
    - misconfig
  # Skip Ansible collections directory
  # Collections contain Jinja2 templates (*.j2) that trigger Dockerfile parse errors
  # Path: /tmp/.venv persists because shell glob '*' doesn't match dotfiles
  skip-dirs:
    - "/tmp/.venv/lib/python3.12/site-packages/ansible_collections"
